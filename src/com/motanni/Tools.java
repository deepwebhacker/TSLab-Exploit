package com.motanni;

import com.motanni.exploit.*;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.util.HashSet;

public class Tools {


    public static boolean checkTheURL(String weburl){
        if(!weburl.startsWith("http")){
            return false;
        }
        return true;
    }
    public static String addTheURL(String weburl){
        if(!weburl.startsWith("http")){
            weburl="http://"+weburl;
        }
        return weburl;
    }

    public static String checkTheDomain(String weburl){
        if ("".equals(weburl.trim())){
            return "";
        }
        if (!weburl.startsWith("https")){
            weburl="https://"+weburl;
        }
        if (!weburl.endsWith("/")){
            weburl = weburl+"/";
        }
        return weburl;
    }

    public static HashSet<String> read(String path,String encode){

        HashSet<String> list=new HashSet<String>();

        FileInputStream fs;

        try {

            fs = new FileInputStream(new File(path));

            InputStreamReader isr=null;

            if(encode.equals("")){
                isr=new InputStreamReader(fs);
            }
            else{
                isr=new InputStreamReader(fs,encode);
            }

            BufferedReader br=new BufferedReader(isr);

            String tem=null;

            while((tem=br.readLine())!=null){
                tem=addTheURL(tem);
                if(!list.contains(tem)){
                    list.add(tem);
                }
            }

            br.close();
            isr.close();

        } catch (Exception e) {

        }

        return list;
    }

    public static BasePayload getPayload(String select){
        BasePayload bp=null;
        if(select.startsWith("深信服EDR命令执行漏洞")){
            bp=new sxf_edr();
        }
        if(select.startsWith("用友GRP-u8命令执行")){
            bp=new GRP_u8();
        }
        if(select.startsWith("宝塔后门漏洞")){
            bp=new baota_backdorr();
        }
        if(select.startsWith("泛微云桥任意文件读取")){
            bp=new fanwei_yunqiao();
        }



        return bp;
    }

}
